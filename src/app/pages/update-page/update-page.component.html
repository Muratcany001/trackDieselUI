<div class="container my-4">
    <h2 class="mb-4">Araç Güncelleme Sayfası</h2>
  
    <div *ngIf="message" class="alert" [ngClass]="{'alert-success': message.includes('başarıyla'), 'alert-danger': !message.includes('başarıyla')}">
      {{ message }}
    </div>
  
    <form [formGroup]="updateForm" (ngSubmit)="updateCar()">
      <div class="mb-3">
        <label for="plateNumber" class="form-label">Plaka Numarası</label>
        <input type="text" id="plateNumber" class="form-control" formControlName="plateNumber" required>
        <div *ngIf="updateForm.get('plateNumber')?.invalid && updateForm.get('plateNumber')?.touched" class="text-danger">
          Plaka numarası gereklidir
        </div>
      </div>
  
      <div class="mb-3">
        <label for="partName" class="form-label">Parça Adı</label>
        <input type="text" id="partName" class="form-control" formControlName="partName" required>
        <div *ngIf="updateForm.get('partName')?.invalid && updateForm.get('partName')?.touched" class="text-danger">
          Parça adı gereklidir
        </div>
      </div>
  
      <div class="mb-3">
        <label for="description" class="form-label">Açıklama</label>
        <textarea id="description" class="form-control" formControlName="description" rows="3" required></textarea>
        <div *ngIf="updateForm.get('description')?.invalid && updateForm.get('description')?.touched" class="text-danger">
          Açıklama gereklidir
        </div>
      </div>
  
      <div class="mb-3 form-check">
        <input type="checkbox" id="isReplaced" class="form-check-input" formControlName="isReplaced">
        <label class="form-check-label" for="isReplaced">Parça Değiştirildi mi?</label>
      </div>
  
      <div class="mb-3">
        <label for="dateReported" class="form-label">Bildirim Tarihi</label>
        <input type="date" id="dateReported" class="form-control" formControlName="dateReported" required>
        <div *ngIf="updateForm.get('dateReported')?.invalid && updateForm.get('dateReported')?.touched" class="text-danger">
          Bildirim tarihi gereklidir
        </div>
      </div>
  
      <div class="mb-3">
        <label for="lastMaintenanceDate" class="form-label">Son Bakım Tarihi</label>
        <input type="date" id="lastMaintenanceDate" class="form-control" formControlName="lastMaintenanceDate" required>
        <div *ngIf="updateForm.get('lastMaintenanceDate')?.invalid && updateForm.get('lastMaintenanceDate')?.touched" class="text-danger">
          Son bakım tarihi gereklidir
        </div>
      </div>
  
      <button type="submit" class="btn btn-primary" [disabled]="updateForm.invalid || isLoading">
        <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
        Güncelle
      </button>
    </form>
  
    <div *ngIf="carDetails.plateNumber" class="mt-4">
      <h3>Güncellenen Araç Bilgileri</h3>
      <div class="card">
        <div class="card-body">
          <p><strong>Plaka:</strong> {{ carDetails.plateNumber }}</p>
          <p><strong>Marka:</strong> {{ carDetails.brand }}</p>
          <p><strong>Model:</strong> {{ carDetails.model }}</p>
          <p><strong>Son Bakım Tarihi:</strong> {{ carDetails.lastMaintenanceDate | date:'dd/MM/yyyy' }}</p>
          
          <h4 class="mt-3">Hata Geçmişi</h4>
          <ul class="list-group">
            <li *ngFor="let error of carDetails.errorHistory" class="list-group-item">
              <p><strong>Parça:</strong> {{ error.partName }}</p>
              <p><strong>Açıklama:</strong> {{ error.description }}</p>
              <p><strong>Değiştirildi mi:</strong> {{ error.isReplaced ? 'Evet' : 'Hayır' }}</p>
              <p><strong>Bildirim Tarihi:</strong> {{ error.dateReported | date:'dd/MM/yyyy' }}</p>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>